From bdf65393678544a857b588245b2d1f37f25f0acc Mon Sep 17 00:00:00 2001
From: ShevT <shev_t@mail.ru>
Date: Tue, 14 Mar 2017 11:41:38 +0300
Subject: [PATCH] fwb: Fix Sending non-protected broadcast PROXIMITY_CP and
 GRIPSENSOR_CP

This patch fixes errors:
E ActivityManager: Sending non-protected broadcast android.intent.action.PROXIMITY_CP from system uid 1001 pkg null
E ActivityManager: Sending non-protected broadcast android.intent.action.GRIPSENSOR_CP from system uid 1001 pkg null

project frameworks/base/
diff --git a/frameworks/base/core/java/android/content/Intent.java b/frameworks/base/core/java/android/content/Intent.java
index 861aae5a879..5edbc288674 100644
--- a/frameworks/base/core/java/android/content/Intent.java
+++ b/frameworks/base/core/java/android/content/Intent.java
@@ -3291,6 +3291,17 @@ public class Intent implements Parcelable, Cloneable {
     public static final int EXTRA_THERMAL_STATE_EXCEEDED = 2;
 
 
+    /**
+     * ACTIVITY INTENT ACTION PROXIMITY_CP, GRIPSENSOR_CP
+     */
+    /** {@hide} */
+    @SdkConstant(SdkConstantType.ACTIVITY_INTENT_ACTION)
+    public static final String PROXIMITY_CP = "android.intent.action.PROXIMITY_CP";
+
+    /** {@hide} */
+    @SdkConstant(SdkConstantType.ACTIVITY_INTENT_ACTION)
+    public static final String GRIPSENSOR_CP = "android.intent.action.GRIPSENSOR_CP";
+
     // ---------------------------------------------------------------------
     // ---------------------------------------------------------------------
     // Standard intent categories (see addCategory()).
diff --git a/frameworks/base/core/res/AndroidManifest.xml b/frameworks/base/core/res/AndroidManifest.xml
index 2c76dee9754..44603b30efc 100644
--- a/frameworks/base/core/res/AndroidManifest.xml
+++ b/frameworks/base/core/res/AndroidManifest.xml
@@ -508,6 +508,9 @@
     <protected-broadcast android:name="android.intent.action.MANAGED_PROFILE_UNAVAILABLE" />
     <protected-broadcast android:name="com.android.server.pm.DISABLE_QUIET_MODE_AFTER_UNLOCK" />
 
+    <protected-broadcast android:name="android.intent.action.GRIPSENSOR_CP" />
+    <protected-broadcast android:name="android.intent.action.PROXIMITY_CP" />
+
     <protected-broadcast android:name="android.telecom.action.TTY_PREFERRED_MODE_CHANGED" />
     <protected-broadcast android:name="android.telecom.action.CURRENT_TTY_MODE_CHANGED" />
     <protected-broadcast android:name="com.android.server.retaildemo.ACTION_RESET_DEMO" />
-- 
2.11.0
